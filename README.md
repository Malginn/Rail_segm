# Rail_segm

## Создание модели для сегментации объектов на железнодорожных путях

- у нас есть стрелки(switches) - пошерстные и противошерстные
- нам мужно собрать качественные данные и разметить
- подобрать архитекутры, пример: `Yolov8-seg, sam`
- создать модель и протестировать ее на видео объектах

## Классы:
1) поиск стрелок
2) шерстные противошертсные
3) 2 + люди
4) 3 + рельсы

### Что я понял из первого прочтения перевода статьи самого близкого к задаче датасета?

- Люди собирали данные из извсетных больших датасетов с изображениями и делали экономную разметку с разными полигонами, боксами и классами, полуавтоматизировали разметку в deeplab3 и какой-то еще моделью
- в pytorch есть библиотека pytorch-segmen, где есть модели для сегментации
- там много разных проблем с разными объектами, различие парвого свитча и левого сложно, знаков и тд. геометрические фигуры и интерполяция с аппроксимацией(сложно)
- у нас есть данные, подготовленные хорошей научной группой и мы можем изменять их как нам вздумается и смотреть метрику mIoU, чтобы оценивать каество нашей модели.
надо бы решаить какая модель и стоит ли накручивать svm
- для классов переключателей нет полигонов или RLE, поэтому размечать следует самому

Вопросы:
1) Что именно является стрелкой, пересечение рельс можно сегментировать, как стрелку?
2) Сколько классов в продакшене должно быть?(Для начала выбрали один класс - переключатели)
3) Какой процент контрпримеров стоит брать
4) Какую метрику в частности нужно отслеживать? (IoU, mAP50, ...)

TODO: 
 - Добавить аугментацию
 - Отрефакторить код и на навести файл менеджмент
 - Допилить кастомную функцию для расчета IoU и сделать валидацию по 
 - Рассмотреть ее решение на более низком уровне, чем API ultralytics

 (у нас будут предобработанные данные, которые будут в формате для yolo, мы можем сегментировать наш класс и еще будем расчитывать метрику, на которую смотрит михаил) Останется только дорабатывать модель, добавлять классы и улучшать точность модели, возможно сделать ее на более низком урвоне, а не через API ultralytics


